<!DOCTYPE html>
<html lang="en">
<head>
    <title>JavTube</title>
</head>
<body>
<div class="page type-interior pluginConfigurationPage"
     data-require="emby-input,emby-button,emby-select,emby-checkbox"
     data-role="page"
     id="JavTubeConfigurationPage">
    <div data-role="content">
        <div class="content-primary">
            <h1>JavTube</h1>
            <form id="JavTubeConfigForm">
                <div class="inputContainer">
                    <label class="inputeLabel inputLabelUnfocused" for="txtServer">Server</label>
                    <input id="txtServer" is="emby-input" name="txtServer" required type="text"/>
                    <div class="fieldDescription">URL of JavTube Server.</div>
                </div>
                <div class="inputContainer">
                    <label class="inputeLabel inputLabelUnfocused" for="txtToken">Token</label>
                    <input id="txtToken" is="emby-input" name="txtToken" type="text"/>
                    <div class="fieldDescription">Access Token of JavTube Server.</div>
                </div>
                <div class="checkboxContainer checkboxContainer-withDescripton">
                    <label class="emby-checkbox-label">
                        <input id="chkTranslation" is="emby-checkbox" name="chkTranslation"
                               type="checkbox"/>
                        <span>Enable Auto Translation</span>
                    </label>
                </div>
                <div>
                    <button class="raised button-submit block" is="emby-button" type="submit">
                        <span>Save</span></button>
                </div>
            </form>
        </div>
    </div>
    <script type="text/javascript">
        var JavTubePluginConfig = {
            uniquePluginId: "01cc53ec-c415-4108-bbd4-a684a9801a32"
        };

        $('#JavTubeConfigurationPage').on('pageshow', function () {
            Dashboard.showLoadingMsg();
            ApiClient.getPluginConfiguration(JavTubePluginConfig.uniquePluginId).then(function (config) {
                $('#txtServer').val(config.Server).change();
                $('#txtToken').val(config.Token).change();
                $('#chkTranslation').prop('checked', config.EnableAutoTranslation);
                Dashboard.hideLoadingMsg();
            });
        });

        $('#JavTubeConfigForm').on('submit', function () {
            Dashboard.showLoadingMsg();
            ApiClient.getPluginConfiguration(JavTubePluginConfig.uniquePluginId).then(function (config) {
                config.Server = $('#txtServer').val();
                config.Token = $('#txtToken').val();
                config.EnableAutoTranslation = $('#chkTranslation').prop('checked');
                ApiClient.updatePluginConfiguration(JavTubePluginConfig.uniquePluginId, config).then(
                    Dashboard.processPluginConfigurationUpdateResult);
            });
            return false;
        });
    </script>
</div>
</body>
</html>